<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>颜色值转换器</title>
    <link href="https://unpkg.com/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../../asset/common.css">
    <link rel="stylesheet" href="https://unpkg.com/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <style>
        .color-preview {
            width: 100%;
            height: 100px;
            border-radius: 0.375rem;
            border: 1px solid #dee2e6;
            margin-bottom: 1rem;
        }
    </style>
</head>
<body>
    <!-- 导航栏 -->
    <div id="navbar-container"></div>
    
    <div class="container container-main">
        <!-- 面包屑导航 -->
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item">数据转换</li>
                <li class="breadcrumb-item active" aria-current="page">颜色值转换</li>
            </ol>
        </nav>
        
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0">颜色值转换工具</h5>
            </div>
            <div class="card-body">
                <div class="row mb-3">
                    <div class="col-md-6">
                        <div class="color-preview" id="colorPreview" style="background-color: #3498db;"></div>
                    </div>
                    <div class="col-md-6">
                        <label for="colorInput" class="form-label">输入颜色值</label>
                        <div class="input-group mb-3">
                            <input type="text" class="form-control" id="colorInput" placeholder="#3498db 或 rgb(52, 152, 219)" value="#3498db">
                            <button class="btn btn-outline-secondary" type="button" id="detectFormatBtn">自动检测</button>
                        </div>
                        <div class="mb-3">
                            <label for="inputFormat" class="form-label">输入格式</label>
                            <select class="form-select" id="inputFormat">
                                <option value="hex">HEX (#RRGGBB)</option>
                                <option value="rgb">RGB (rgb(r, g, b))</option>
                                <option value="hsl">HSL (hsl(h, s%, l%))</option>
                            </select>
                        </div>
                        <!-- 添加颜色选择器 -->
                        <div class="mb-3">
                            <label for="colorPicker" class="form-label">颜色选择器</label>
                            <input type="color" class="form-control form-control-color" id="colorPicker" value="#3498db" title="选择颜色">
                        </div>
                    </div>
                </div>
                
                <div class="d-flex justify-content-between mb-3">
                    <div>
                        <button id="convertBtn" class="btn btn-primary me-2">
                            <i class="bi bi-arrow-repeat me-1"></i>
                            执行转换
                        </button>
                    </div>
                    <div>
                        <button id="clearBtn" class="btn btn-danger">
                            <i class="bi bi-trash me-1"></i>
                            清空
                        </button>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-4 mb-3">
                        <div class="card h-100">
                            <div class="card-header">
                                <h6 class="mb-0">HEX (#RRGGBB)</h6>
                            </div>
                            <div class="card-body">
                                <p class="card-text font-monospace" id="hexResult">#3498db</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <div class="card h-100">
                            <div class="card-header">
                                <h6 class="mb-0">RGB (rgb(r, g, b))</h6>
                            </div>
                            <div class="card-body">
                                <p class="card-text font-monospace" id="rgbResult">rgb(52, 152, 219)</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <div class="card h-100">
                            <div class="card-header">
                                <h6 class="mb-0">HSL (hsl(h, s%, l%))</h6>
                            </div>
                            <div class="card-body">
                                <p class="card-text font-monospace" id="hslResult">hsl(204, 69%, 53%)</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 百科内容 -->
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">关于颜色值转换</h5>
            </div>
            <div class="card-body">
                <h6>颜色模型简介</h6>
                <p>
                    颜色模型是用于描述和重现颜色的数学模型。在数字媒体中，常用的颜色模型包括 RGB、HEX 和 HSL。
                </p>
                
                <h6>常见的颜色表示方法</h6>
                <ul>
                    <li><strong>HEX (十六进制)：</strong>以 # 开头，后跟六个十六进制字符 (0-9, A-F)，分别表示红、绿、蓝三个通道的值。例如 #FF0000 表示红色。</li>
                    <li><strong>RGB (红绿蓝)：</strong>通过指定红(Red)、绿(Green)、蓝(Blue)三个通道的值来表示颜色，每个通道的取值范围是 0-255。例如 rgb(255, 0, 0) 表示红色。</li>
                    <li><strong>HSL (色相、饱和度、亮度)：</strong>通过色相(Hue)、饱和度(Saturation)、亮度(Lightness)来表示颜色。色相取值范围为 0-360 度，饱和度和亮度取值范围为 0%-100%。例如 hsl(0, 100%, 50%) 表示红色。</li>
                </ul>
                
                <h6>颜色转换原理</h6>
                <p>
                    不同颜色模型间的转换需要通过数学公式实现：
                </p>
                <ul>
                    <li><strong>RGB ↔ HEX：</strong>RGB 的每个分量可以直接转换为两位十六进制数</li>
                    <li><strong>RGB ↔ HSL：</strong>需要通过一系列三角函数计算进行转换</li>
                </ul>
                
                <h6>常见用途</h6>
                <ul>
                    <li>网页设计中的颜色选择和搭配</li>
                    <li>图像处理软件中的颜色调整</li>
                    <li>UI 设计中的色彩规范制定</li>
                    <li>印刷和数字媒体中的颜色匹配</li>
                </ul>
                
                <h6>如何使用本工具</h6>
                <ol>
                    <li>在输入框中输入任意格式的颜色值</li>
                    <li>选择正确的输入格式或使用自动检测功能</li>
                    <li>点击"执行转换"按钮</li>
                    <li>在下方查看转换到各种格式的结果</li>
                    <li>使用"清空"按钮清除当前输入和结果</li>
                </ol>
                
                <h6>注意事项</h6>
                <ul>
                    <li>输入的颜色值必须符合所选格式的规则</li>
                    <li>工具支持常见的颜色格式转换，对于特殊需求可能需要专业工具</li>
                    <li>工具完全在浏览器中运行，不会上传任何数据</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div id="footer-container"></div>

    <script src="https://unpkg.com/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../../asset/navbar.js"></script>
    <script src="../../asset/footer.js"></script>
    <script src="../../asset/common.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const colorInput = document.getElementById('colorInput');
            const inputFormat = document.getElementById('inputFormat');
            const colorPreview = document.getElementById('colorPreview');
            const hexResult = document.getElementById('hexResult');
            const rgbResult = document.getElementById('rgbResult');
            const hslResult = document.getElementById('hslResult');
            
            // 执行转换
            document.getElementById('convertBtn').addEventListener('click', function() {
                try {
                    const value = colorInput.value.trim();
                    const format = inputFormat.value;
                    
                    if (!value) {
                        showToast('请输入颜色值', 'error');
                        return;
                    }
                    
                    let rgb, hex, hsl;
                    
                    switch(format) {
                        case 'hex':
                            if (!isValidHex(value)) {
                                showToast('输入的HEX颜色值格式不正确', 'error');
                                return;
                            }
                            hex = normalizeHex(value);
                            rgb = hexToRgb(hex);
                            hsl = rgbToHsl(rgb.r, rgb.g, rgb.b);
                            break;
                        case 'rgb':
                            const rgbObj = parseRgb(value);
                            if (!rgbObj) {
                                showToast('输入的RGB颜色值格式不正确', 'error');
                                return;
                            }
                            rgb = rgbObj;
                            hex = rgbToHex(rgb.r, rgb.g, rgb.b);
                            hsl = rgbToHsl(rgb.r, rgb.g, rgb.b);
                            break;
                        case 'hsl':
                            const hslObj = parseHsl(value);
                            if (!hslObj) {
                                showToast('输入的HSL颜色值格式不正确', 'error');
                                return;
                            }
                            hsl = hslObj;
                            rgb = hslToRgb(hsl.h, hsl.s, hsl.l);
                            hex = rgbToHex(rgb.r, rgb.g, rgb.b);
                            break;
                        default:
                            showToast('不支持的颜色格式', 'error');
                            return;
                    }
                    
                    // 更新显示
                    hexResult.textContent = hex;
                    rgbResult.textContent = `rgb(${rgb.r}, ${rgb.g}, ${rgb.b})`;
                    hslResult.textContent = `hsl(${Math.round(hsl.h)}, ${Math.round(hsl.s)}%, ${Math.round(hsl.l)}%)`;
                    colorPreview.style.backgroundColor = hex;
                    colorPicker.value = hex; // 同步颜色选择器
                } catch (e) {
                    showToast('转换出错: ' + e.message, 'error');
                }
            });
            
            // 自动检测格式
            document.getElementById('detectFormatBtn').addEventListener('click', function() {
                const value = colorInput.value.trim();
                if (!value) {
                    showToast('请输入颜色值', 'error');
                    return;
                }
                
                if (isValidHex(value)) {
                    inputFormat.value = 'hex';
                    showToast('检测为HEX格式', 'info');
                } else if (parseRgb(value)) {
                    inputFormat.value = 'rgb';
                    showToast('检测为RGB格式', 'info');
                } else if (parseHsl(value)) {
                    inputFormat.value = 'hsl';
                    showToast('检测为HSL格式', 'info');
                } else {
                    showToast('无法识别的颜色格式', 'error');
                }
            });
            
            // 清空功能
            document.getElementById('clearBtn').addEventListener('click', function() {
                colorInput.value = '';
                hexResult.textContent = '-';
                rgbResult.textContent = '-';
                hslResult.textContent = '-';
                colorPreview.style.backgroundColor = '#3498db';
                colorPicker.value = '#3498db';
            });
            
            // 颜色选择器事件
            document.getElementById('colorPicker').addEventListener('input', function() {
                const hex = this.value;
                colorInput.value = hex;
                inputFormat.value = 'hex';
                colorPreview.style.backgroundColor = hex;
                
                // 自动触发转换
                const event = new MouseEvent('click', {
                    view: window,
                    bubbles: true,
                    cancelable: true
                });
                document.getElementById('convertBtn').dispatchEvent(event);
            });
            
            // HEX转RGB
            function hexToRgb(hex) {
                const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
                return result ? {
                    r: parseInt(result[1], 16),
                    g: parseInt(result[2], 16),
                    b: parseInt(result[3], 16)
                } : null;
            }
            
            // RGB转HEX
            function rgbToHex(r, g, b) {
                return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
            }
            
            // RGB转HSL
            function rgbToHsl(r, g, b) {
                r /= 255, g /= 255, b /= 255;
                const max = Math.max(r, g, b), min = Math.min(r, g, b);
                let h, s, l = (max + min) / 2;

                if (max === min) {
                    h = s = 0; // achromatic
                } else {
                    const d = max - min;
                    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                    switch (max) {
                        case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                        case g: h = (b - r) / d + 2; break;
                        case b: h = (r - g) / d + 4; break;
                    }
                    h /= 6;
                }

                return { h: h * 360, s: s * 100, l: l * 100 };
            }
            
            // HSL转RGB
            function hslToRgb(h, s, l) {
                h /= 360;
                s /= 100;
                l /= 100;
                let r, g, b;

                if (s === 0) {
                    r = g = b = l; // achromatic
                } else {
                    const hue2rgb = (p, q, t) => {
                        if (t < 0) t += 1;
                        if (t > 1) t -= 1;
                        if (t < 1/6) return p + (q - p) * 6 * t;
                        if (t < 1/2) return q;
                        if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
                        return p;
                    };

                    const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
                    const p = 2 * l - q;
                    r = hue2rgb(p, q, h + 1/3);
                    g = hue2rgb(p, q, h);
                    b = hue2rgb(p, q, h - 1/3);
                }

                return { r: Math.round(r * 255), g: Math.round(g * 255), b: Math.round(b * 255) };
            }
            
            // 验证HEX格式
            function isValidHex(value) {
                return /^#?[0-9A-F]{6}$/i.test(value);
            }
            
            // 标准化HEX格式
            function normalizeHex(hex) {
                if (hex.startsWith('#')) {
                    return hex.toUpperCase();
                }
                return '#' + hex.toUpperCase();
            }
            
            // 解析RGB格式
            function parseRgb(value) {
                const match = value.match(/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i);
                if (match) {
                    const r = parseInt(match[1]), g = parseInt(match[2]), b = parseInt(match[3]);
                    if (r >= 0 && r <= 255 && g >= 0 && g <= 255 && b >= 0 && b <= 255) {
                        return { r, g, b };
                    }
                }
                return null;
            }
            
            // 解析HSL格式
            function parseHsl(value) {
                const match = value.match(/^hsl\s*\(\s*(\d+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*\)$/i);
                if (match) {
                    const h = parseInt(match[1]), s = parseInt(match[2]), l = parseInt(match[3]);
                    if (h >= 0 && h <= 360 && s >= 0 && s <= 100 && l >= 0 && l <= 100) {
                        return { h, s, l };
                    }
                }
                return null;
            }
        });
    </script>
</body>
</html>